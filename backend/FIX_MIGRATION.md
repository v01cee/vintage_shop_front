# Исправление проблемы с миграциями

## Проблема 1: Alembic ищет ревизию '0003', но файла миграции нет
## Проблема 2: Таблицы уже существуют в БД (DuplicateTable error)

## Решение

### Вариант 1: Использовать обновленную миграцию (рекомендуется)

Миграция теперь проверяет существование таблиц перед созданием. Просто примените её:
```bash
cd backend
alembic upgrade head
```

Если таблицы уже существуют, миграция пропустит их создание.

### Вариант 2: Если таблицы уже существуют - пометить миграцию как примененную

Если все таблицы уже созданы, можно просто пометить миграцию как примененную:
```bash
cd backend
alembic stamp head
```

Это обновит таблицу `alembic_version` без попытки создать таблицы заново.

### Вариант 3: Проверить состояние БД

Запустите скрипт для проверки:
```bash
cd backend
python check_and_stamp_migration.py
```

Скрипт покажет:
- Какие таблицы существуют
- Какие отсутствуют
- Что нужно сделать дальше

### Вариант 4: Сбросить состояние миграций

Если нужно начать заново:
```bash
cd backend
python reset_alembic.py
alembic upgrade head
```

## После исправления

После успешного применения миграции можно удалить временные скрипты:
```bash
rm reset_alembic.py
rm check_and_stamp_migration.py
```



